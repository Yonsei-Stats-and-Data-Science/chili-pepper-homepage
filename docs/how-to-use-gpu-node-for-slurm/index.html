<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>4. GPU node ì‚¬ìš©ë²•(Python) | Chili Pepper</title>
<meta name="keywords" content="" />
<meta name="description" content="4. GPU node ì‚¬ìš©ë²•(Python) 2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ë¥¼ ë¨¼ì € ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” 2ë²ˆ ë¬¸ì„œì˜ Step 1, 2, 3 ì´í›„ì˜ ë‚´ìš©ë§Œì„ ë‹¤ë£¹ë‹ˆë‹¤.
GPU-compute nodeì—ì„œëŠ” Pythonë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
Step 4. Export your conda setting ë²„ì „ ê´€ë¦¬ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ë²„ì „ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.
 GPU ë“œë¼ì´ë²„ ë²„ì „(418.67) Python ë²„ì „ CUDA ë²„ì „(í˜¸í™˜ì„± í‘œ) cuDNN, ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬(tensorflow, pytorch) ë²„ì „(í˜¸í™˜ì„± í‘œ: tensorflow, pytorch)  ì´ë“¤ì˜ ë²„ì „ ê°„ í˜¸í™˜ì´ ë˜ëŠ” ì¡°í•©ì„ ìˆ™ì§€í•˜ê³  ì´ì— ë”°ë¼ conda environmentë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.">
<meta name="author" content="Gwnaghee Kim, Jongmin Mun">
<link rel="canonical" href="https://hpc.stat.yonsei.ac.kr/docs/how-to-use-gpu-node-for-slurm/" />
<meta name="google-site-verification" content="XYZabc" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.c88963fe2d79462000fd0fb1b3737783c32855d340583e4523343f8735c787f0.css" integrity="sha256-yIlj/i15RiAA/Q&#43;xs3N3g8MoVdNAWD5FIzQ/hzXHh/A=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://hpc.stat.yonsei.ac.kr/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hpc.stat.yonsei.ac.kr/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hpc.stat.yonsei.ac.kr/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hpc.stat.yonsei.ac.kr/apple-touch-icon.png">
<link rel="mask-icon" href="https://hpc.stat.yonsei.ac.kr/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.91.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="4. GPU node ì‚¬ìš©ë²•(Python)" />
<meta property="og:description" content="4. GPU node ì‚¬ìš©ë²•(Python) 2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ë¥¼ ë¨¼ì € ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” 2ë²ˆ ë¬¸ì„œì˜ Step 1, 2, 3 ì´í›„ì˜ ë‚´ìš©ë§Œì„ ë‹¤ë£¹ë‹ˆë‹¤.
GPU-compute nodeì—ì„œëŠ” Pythonë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
Step 4. Export your conda setting ë²„ì „ ê´€ë¦¬ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ë²„ì „ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.
 GPU ë“œë¼ì´ë²„ ë²„ì „(418.67) Python ë²„ì „ CUDA ë²„ì „(í˜¸í™˜ì„± í‘œ) cuDNN, ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬(tensorflow, pytorch) ë²„ì „(í˜¸í™˜ì„± í‘œ: tensorflow, pytorch)  ì´ë“¤ì˜ ë²„ì „ ê°„ í˜¸í™˜ì´ ë˜ëŠ” ì¡°í•©ì„ ìˆ™ì§€í•˜ê³  ì´ì— ë”°ë¼ conda environmentë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://hpc.stat.yonsei.ac.kr/docs/how-to-use-gpu-node-for-slurm/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2022-03-17T14:54:35&#43;09:00" />
<meta property="article:modified_time" content="2022-03-17T14:54:35&#43;09:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="4. GPU node ì‚¬ìš©ë²•(Python)"/>
<meta name="twitter:description" content="4. GPU node ì‚¬ìš©ë²•(Python) 2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ë¥¼ ë¨¼ì € ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” 2ë²ˆ ë¬¸ì„œì˜ Step 1, 2, 3 ì´í›„ì˜ ë‚´ìš©ë§Œì„ ë‹¤ë£¹ë‹ˆë‹¤.
GPU-compute nodeì—ì„œëŠ” Pythonë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
Step 4. Export your conda setting ë²„ì „ ê´€ë¦¬ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ë²„ì „ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.
 GPU ë“œë¼ì´ë²„ ë²„ì „(418.67) Python ë²„ì „ CUDA ë²„ì „(í˜¸í™˜ì„± í‘œ) cuDNN, ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬(tensorflow, pytorch) ë²„ì „(í˜¸í™˜ì„± í‘œ: tensorflow, pytorch)  ì´ë“¤ì˜ ë²„ì „ ê°„ í˜¸í™˜ì´ ë˜ëŠ” ì¡°í•©ì„ ìˆ™ì§€í•˜ê³  ì´ì— ë”°ë¼ conda environmentë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Docs",
      "item": "https://hpc.stat.yonsei.ac.kr/docs/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "4. GPU node ì‚¬ìš©ë²•(Python)",
      "item": "https://hpc.stat.yonsei.ac.kr/docs/how-to-use-gpu-node-for-slurm/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "4. GPU node ì‚¬ìš©ë²•(Python)",
  "name": "4. GPU node ì‚¬ìš©ë²•(Python)",
  "description": "4. GPU node ì‚¬ìš©ë²•(Python) 2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ë¥¼ ë¨¼ì € ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” 2ë²ˆ ë¬¸ì„œì˜ Step 1, 2, 3 ì´í›„ì˜ ë‚´ìš©ë§Œì„ ë‹¤ë£¹ë‹ˆë‹¤.\nGPU-compute nodeì—ì„œëŠ” Pythonë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.\nStep 4. Export your conda setting ë²„ì „ ê´€ë¦¬ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ë²„ì „ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.\n GPU ë“œë¼ì´ë²„ ë²„ì „(418.67) Python ë²„ì „ CUDA ë²„ì „(í˜¸í™˜ì„± í‘œ) cuDNN, ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬(tensorflow, pytorch) ë²„ì „(í˜¸í™˜ì„± í‘œ: tensorflow, pytorch)  ì´ë“¤ì˜ ë²„ì „ ê°„ í˜¸í™˜ì´ ë˜ëŠ” ì¡°í•©ì„ ìˆ™ì§€í•˜ê³  ì´ì— ë”°ë¼ conda environmentë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤.",
  "keywords": [
    
  ],
  "articleBody": "4. GPU node ì‚¬ìš©ë²•(Python) 2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ë¥¼ ë¨¼ì € ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” 2ë²ˆ ë¬¸ì„œì˜ Step 1, 2, 3 ì´í›„ì˜ ë‚´ìš©ë§Œì„ ë‹¤ë£¹ë‹ˆë‹¤.\nGPU-compute nodeì—ì„œëŠ” Pythonë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.\nStep 4. Export your conda setting ë²„ì „ ê´€ë¦¬ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ë²„ì „ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.\n GPU ë“œë¼ì´ë²„ ë²„ì „(418.67) Python ë²„ì „ CUDA ë²„ì „(í˜¸í™˜ì„± í‘œ) cuDNN, ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬(tensorflow, pytorch) ë²„ì „(í˜¸í™˜ì„± í‘œ: tensorflow, pytorch)  ì´ë“¤ì˜ ë²„ì „ ê°„ í˜¸í™˜ì´ ë˜ëŠ” ì¡°í•©ì„ ìˆ™ì§€í•˜ê³  ì´ì— ë”°ë¼ conda environmentë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. GPU-compute nodeì˜ GPU ë“œë¼ì´ë²„ ë²„ì „ì€ 418.67ìœ¼ë¡œ ê³ ì •ë˜ì–´ ìˆì§€ë§Œ, ë‚˜ë¨¸ì§€ ë²„ì „ì€ conda environmentë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨, Python ë²„ì „ì˜ ê²½ìš° gpu-compute nodeì—ëŠ” conda version 4.6.14ê°€ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ 3.8ê¹Œì§€ë§Œ ì§€ì›í•©ë‹ˆë‹¤.\nGPU ë“œë¼ì´ë²„ ë²„ì „(418.67)ì— ë§ëŠ” Python ë²„ì „ê³¼ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì„ ì •í•œ ë‹¤ìŒ conda create ëª…ë ¹ì–´ì—ì„œ ë²„ì „ì„ ëª…ì‹œí•´ ì£¼ë©´ ì•Œì•„ì„œ CUDAì™€ cuDNN ë²„ì „ì„ ë§ì¶° ì¤ë‹ˆë‹¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.\nì´ íŠœí† ë¦¬ì–¼ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë²„ì „ì€ tensorflow-gpu-2.2.0ì…ë‹ˆë‹¤.\n1. localì—ì„œ conda environment ìƒì„± 1  conda create -n testEnvGPU python=3.7   ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.\n1 2 3 4 5 6 7 8 9 10 11  Preparing transaction: done Verifying transaction: done Executing transaction: done # # To activate this environment, use # # $ conda activate testEnv # # To deactivate an active environment, use # # $ conda deactivate   ì•„ë˜ ì»¤ë§¨ë“œë¥¼ í†µí•´ virtual environmentê°€ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.\n1  conda info --env   1 2 3 4  # conda environments: # base * /opt/miniconda3 testEnvGPU /opt/miniconda3/envs/testEnvGPU   Virtual environmentì— ì§„ì…í•œ ë’¤ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.\n pipë¡œ ì„¤ì¹˜ë˜ëŠ” íŒ¨í‚¤ì§€ë“¤ì€ condaë¡œ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì˜ì¡´ì„± ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ condaë§Œì„ ì‚¬ìš©í•´ì„œ ì„¤ì¹˜í•˜ì‹¤ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤. anaconda ì›¹ì‚¬ì´íŠ¸ì—ì„œ íŒ¨í‚¤ì§€ëª…ì„ ê²€ìƒ‰í•´ì„œ linux-64ë¥¼ ì§€ì›í•˜ëŠ” ë²„ì „ì´ ì–´ë””ê¹Œì§€ì¸ì§€ë¥¼ í™•ì¸í•˜ê³  ì„¤ì¹˜í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ëŠ” ì„¤ì¹˜ ì»¤ë§¨ë“œë„ ì œê³µí•©ë‹ˆë‹¤. ì—¬ëŸ¬ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ê²½ìš° í•œ ì»¤ë§¨ë“œ ë‚´ì— ëª…ì‹œí•˜ë©´ condaê°€ ìë™ìœ¼ë¡œ dependency ì¶©ëŒì„ ê²€ì‚¬í•´ ì¤ë‹ˆë‹¤. íŒ¨í‚¤ì§€ ë²„ì „ì„ ëª…ì‹œí•  ë•ŒëŠ” **=**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.  1 2 3 4  conda activate testEnvGPU #For example, conda install -c anaconda tensorflow-gpu=2.2.0 cudatoolkit cudnn matplotlib scikit-learn pandas numpy   ì•„ë˜ ëª…ë ¹ì–´ë¡œ cudatoolkit, cudnn ë²„ì „ì„ í™•ì¸í•˜ì—¬ batch\n1  conda list   2. GPU-compute nodeì—ì„œ ë™ì¼í•œ conda environment êµ¬ì¶• 2.1. ì¤‘ìš” íŒ¨í‚¤ì§€ì˜ ë²„ì „ë§Œ ë§ì¶”ê¸° 2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ì—ì„œ í•œ ê²ƒì²˜ëŸ¼ tensorflow ë“±ì˜ ë²„ì „ë§Œ ë™ì¼í•˜ê²Œ í•˜ì—¬ GPU-compute nodeì—ì„œ conda createë¡œ conda environmentë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n ì´ ë°©ë²•ì€ 2ë²ˆ ë¬¸ì„œì˜ ì•ˆë‚´ë¥¼ ë”°ë¼ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì„¤ëª…ì„ ìƒëµí•˜ê³  sbatch scriptë§Œ ì œì‹œí•©ë‹ˆë‹¤. Slurm job configuratorì—ì„œ Using GPUì— ì²´í¬í•œë‹¤ëŠ” ì ë§Œ ë‹¤ë¦…ë‹ˆë‹¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë²„ì „ì€ tensorflow-gpu-2.2.0ì…ë‹ˆë‹¤.  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  #!/bin/bash #SBATCH --job-name=conda-env-create #SBATCH --nodes=1 #SBATCH --mem=4gb #SBATCH --partition=all #SBATCH --nodelist=gpu-compute #SBATCH --output=testEnvGPU.log #SBATCH --error=testEnvGPU.err CONDA_BIN_PATH=/opt/miniconda/bin ENV_NAME=testEnvGPU #localì—ì„œì™€ ê°™ì€ ì´ë¦„ìœ¼ë¡œ ì…ë ¥ ENV_PATH=/mnt/nas/users/$(whoami)/.conda/envs/$ENV_NAME $CONDA_BIN_PATH/conda env remove --prefix $ENV_PATH $CONDA_BIN_PATH/conda create -y --prefix $ENV_PATH python=3.7 source $CONDA_BIN_PATH/activate $ENV_PATH conda install tensorflow-gpu=2.2.0   2.2. local environment exportí•˜ê¸° Localì—ì„œ ìƒì„±ëœ ê°€ìƒí™˜ê²½ìœ¼ë¡œë¶€í„° í™˜ê²½ì„¤ì • yml íŒŒì¼ì„ ë§Œë“¤ê³ , ì´ë¥¼ ì´ìš©í•´ GPU-compute nodeì—ì„œ conda environmentë¥¼ ìƒì„±í•˜ì—¬ conda í™˜ê²½ì„ ë™ì¼í•˜ê²Œ ë§ì¶œ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ê²Œ ê°€ì¥ ì´ìƒì ì¸ ë°©ë²•ì´ì§€ë§Œ, local OSê°€ linuxê°€ ì•„ë‹ ê²½ìš° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì„œì—ì„œëŠ” ì´ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.\nLocalì—ì„œ ì•„ë˜ ì»¤ë§¨ë“œë¡œ yml íŒŒì¼ì„ ì¶”ì¶œí•©ë‹ˆë‹¤.\n1 2 3  # export conda setting conda activate [YOUR ENV NAME] conda env export -n [ENV NAME] -f [FILENAME].yml --no-builds # ì´ëŸ¬ë©´ ë¬¸ì œê°€ í•´ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   yml íŒŒì¼ì„ í´ëŸ¬ìŠ¤í„° ë‚´ user home directoryë¡œ ì˜®ê¸°ê³  ì•„ë˜ ì»¤ë§¨ë“œë¥¼ slurm job scriptì— ì¶”ê°€í•˜ê³  sbatchë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ ë•Œ Slurm job configuratorì—ì„œ Using GPUì— ì²´í¬í•´ì•¼ í•©ë‹ˆë‹¤.\n1 2 3 4 5 6  # create environment from file conda create --name [YOUR ENV NAME] python = [VESTION] # same env name in yml file conda env create -f [FILENAME].yml conda env create -p [prefix path] -f [filename].yml   â€”no-builds ì˜µì…˜ì€ ì„œë¡œ ë‹¤ë¥¸ OSì—ì„œ conda environment ë‚´ íŒ¨í‚¤ì§€ë“¤ì˜ ë²„ì „ ì¶©ëŒì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤. ì´ ì˜µì…˜ë§Œìœ¼ë¡œ ë¬¸ì œê°€ í•´ê²°ë˜ê¸°ë„ í•˜ì§€ë§Œ, í•´ê²°ë˜ì§€ ì•Šìœ¼ë©´ userê°€ ì§ì ‘ yml íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì—ëŸ¬ ë©”ì‹œì§€ì— ResolvePackageNotFoundë¼ëŠ” ë¬¸êµ¬ê°€ ë‚˜ì˜¤ëŠ”ë°, ì´ ë¬¸êµ¬ ì•„ë˜ì˜ íŒ¨í‚¤ì§€ë“¤ì„ yml íŒŒì¼ì—ì„œ ì‚­ì œí•´ì£¼ë©´ ë¬¸ì œê°€ í•´ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  conda env create -f test.yml Collecting package metadata: done Solving environment: failed # yml íŒŒì¼ì—ì„œ ì•„ë˜ì— ë“±ì¥í•˜ëŠ” íŒ¨í‚¤ì§€ë“¤ì„ ì§€ì›Œì¤ë‹ˆë‹¤. ResolvePackageNotFound: - libgfortran==3.0.1=h93005f0_2 # --no-builds ì˜µì…˜ì„ ì“°ë©´ íŒ¨í‚¤ì§€ ë²„ì „ ì˜†ì˜ ë¹Œë“œ ì •ë³´ê°€ ë‚˜ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤. - pyzmq==17.0.0=py36h1de35cc_1 - python==3.6.6=h4a56312_1003 - prompt_toolkit==1.0.15=py36haeda067_0 - libiconv==1.15=h1de35cc_1004 - sqlite==3.25.3=ha441bb4_0 - six==1.11.0=py36h0e22d5e_1 - cryptography==2.3.1=py36hdbc3d79_1000 - openssl==1.0.2p=h1de35cc_1002 - libxml2==2.9.8=hf14e9c8_1005 - libcxxabi==4.0.1=hebd6815_0 - matplotlib==2.2.3=py36h0e0179f_0 - ptyprocess==0.5.2=py36he6521c3_0    ğŸ’¡ `yml` fileì„ ì´ìš©í•œ conda í™˜ê²½ ì„¤ì •ì€ ë¡œì»¬ê³¼ ì„œë²„ ì‘ì—… í™˜ê²½ì„ ë™ì¼í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ì§€ë§Œ, conda í™˜ê²½ ì„¤ì • ê³¼ì •ì´ ë„ˆë¬´ ë²ˆê±°ë¡­ë‹¤ë©´ requirements.txtë¥¼ ë§Œë“¤ì–´ íŒ¨í‚¤ì§€ ë²„ì „ë§Œ ê´€ë¦¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.  1 2 3 4 5 6 7  conda install --force-reinstall -y -q -c conda-forge --file requirements.txt # --force-reinstall : Install the package even if it already exists. # -y : Yes, do not ask for confirmation. # -q : Quiet, do not display progress bar. # -c : Channels, additional channels to search for packages # conda-forge is recommended   Step 5. Slrum batch script ì‘ì„±í•˜ì—¬ ì„œë²„ì— ì œì¶œí•˜ê¸° 1. Python ì½”ë“œ ì‘ì„± ì´ì œ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‹¤í–‰í•  Python ì½”ë“œë¥¼ localì—ì„œ ì‘ì„±í•©ë‹ˆë‹¤. ë¨¼ì € localì—ì„œ ì½”ë“œê°€ ì˜¤ë¥˜ ì—†ì´ ëŒì•„ê°€ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ê·¸ í›„ í´ëŸ¬ìŠ¤í„°ì˜ user home directoryì— ì˜®ê¸°ê±°ë‚˜, Visual Studio Codeë‚´ì—ì„œ ì‘ì„±í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤.\nì•„ë˜ëŠ” TensorFlow ê³µì‹ í˜ì´ì§€ì— ê²Œì‹œëœ ì´ˆë³´ììš© íŠœí† ë¦¬ì–¼ ì½”ë“œì…ë‹ˆë‹¤. Batch scriptë¥¼ ì‘ì„±í•  ë•ŒëŠ” ì•Œê³ ë¦¬ì¦˜ì˜ outputì´ ìë™ìœ¼ë¡œ ì €ì¥ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ íŒŒì¼ë¡œ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ì½”ë“œë¥¼ í¬í•¨í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œì—ëŠ” ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ì½”ë“œëŠ” ì—†ì§€ë§Œ, **model.evaluate(x_test, y_test, verbose=2)**ê°€ ê²°ê³¼ë¥¼ ì½˜ì†”ì— ì¶œë ¥í•˜ê¸° ë•Œë¬¸ì— ë¡œê·¸ íŒŒì¼ì—ì„œ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ tensor.pyë¼ëŠ” ì´ë¦„ìœ¼ë¡œ user home directoryì— ì €ì¥í•©ë‹ˆë‹¤.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  # tensor.py import tensorflow as tf mnist = tf.keras.datasets.mnist (x_train, y_train), (x_test, y_test) = mnist.load_data() x_train, x_test = x_train / 255.0, x_test / 255.0 model = tf.keras.models.Sequential([ tf.keras.layers.Flatten(input_shape=(28, 28)), tf.keras.layers.Dense(128, activation='relu'), tf.keras.layers.Dropout(0.2), tf.keras.layers.Dense(10, activation='softmax') ]) model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy']) model.fit(x_train, y_train, epochs=5) model.evaluate(x_test, y_test, verbose=2)   2. í˜„ì¬ í´ëŸ¬ìŠ¤í„° ìì› ì‚¬ìš©ëŸ‰ í™•ì¸ ì•„ë˜ ì»¤ë§¨ë“œë¥¼ í†µí•´ cpu-compute ë…¸ë“œì˜ cpuì™€ RAM ì‚¬ìš© í˜„í™©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n1  sinfo -o \"%n %e %m %a %c %C\"   ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.\n1 2 3  HOSTNAMES FREE_MEM MEMORY AVAIL CPUS CPUS(A/I/O/T) cpu-compute 105589 128916 up 32 0/32/0/32 gpu-compute 53318 80532 up 16 0/16/0/16    CPUSì˜ A/I/O/TëŠ” allocated/idle/other/totalì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ìì‹ ì˜ jobì´ ë°”ë¡œ ì‹¤í–‰ë˜ê¸°ë¥¼ ì›í•œë‹¤ë©´, Slurm batch scriptë¥¼ ì‘ì„±í•  ë•Œ  RAM ìš©ëŸ‰ì„ FREE_MEMë³´ë‹¤ ì ê²Œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤. CPU ì½”ì–´ ê°œìˆ˜ë¥¼ CPUS idleë³´ë‹¤ ì ê²Œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.   í˜„ì¬ ê°€ìš© ìì›ë³´ë‹¤ ë” ë§ì€ ìì›ì„ ìš”êµ¬í•˜ëŠ” scriptë¥¼ ì‘ì„±í•˜ë©´, jobì´ ë°”ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ê¸° ìƒíƒœì— ìˆë‹¤ê°€ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì˜ jobì´ ëë‚˜ê³  ìì›ì´ ë°˜í™˜ë˜ë©´ jobì´ ì‹¤í–‰ë©ë‹ˆë‹¤.  3. Slurm batch script ì‘ì„± ì•ì„  ë‹¨ê³„ì—ì„œ ë§Œë“  í•´ë‹¹ conda environmentë¥¼ activateí•˜ê³  ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” Slurm batch scriptë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„° ì†Œê°œ í˜ì´ì§€ì˜ slurm job configuratorë¥¼ ì‚¬ìš©í•˜ë©´ scriptë¥¼ ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n Conda activateì— ì²´í¬í•©ë‹ˆë‹¤. Using GPUì— ì²´í¬í•©ë‹ˆë‹¤. ë¹ˆì¹¸ë“¤ì„ ì±„ì›ë‹ˆë‹¤. Scriptë€ì— python xxx.pyë¼ê³  ì‘ì„±í•©ë‹ˆë‹¤. ì´ëŠ” home directoryì— ìˆëŠ” xxx.py íŒŒì¼ì„ Pythonìœ¼ë¡œ ì‹¤í–‰í•˜ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤. Print \u0026 Copy ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.  ì´ ë¬¸ì„œì—ì„œ ì‚¬ìš©í•œ Slurm batch scriptì˜ ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  #!/bin/bash # #SBATCH --job-name=tensor #SBATCH --partition=all #SBATCH --account=mjm #SBATCH --mem=16gb #SBATCH --ntasks=1 #SBATCH --cpus-per-task=8 #SBATCH --time=00:30:00 #SBATCH --output=/mnt/nas/users/mjm/tensor.log #SBATCH --error=/mnt/nas/users/mjm/tensor.err #SBATCH --gres=gpu:1 #SBATCH --nodelist=gpu-compute CONDA_BIN_PATH=/opt/miniconda/bin ENV_NAME=testEnvGPU ENV_PATH=/mnt/nas/users/$(whoami)/.conda/envs/$ENV_NAME source $CONDA_BIN_PATH/activate $ENV_PATH python tensor.py   tensor.jobì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ì˜ user home directoryì— ì €ì¥í•©ë‹ˆë‹¤.\nsbatchì— ëŒ€í•œ ë” ìì„¸í•œ ì •ë³´ëŠ” Slurm ê³µì‹ ì›¹í˜ì´ì§€ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.\n4. Slurm batch script ì‹¤í–‰ Conda environmentë¥¼ ë§Œë“¤ ë•Œì²˜ëŸ¼, sbatch ì»¤ë§¨ë“œë¥¼ í†µí•´ jobì„ ì œì¶œí•©ë‹ˆë‹¤. í• ë‹¹ë˜ëŠ” job ë²ˆí˜¸ëŠ” ë‚˜ì¤‘ì— job ì •ë³´ë¥¼ í™•ì¸í•˜ê±°ë‚˜ jobì„ ì·¨ì†Œí•  ë•Œ ì´ìš©ë˜ë¯€ë¡œ ê¸°ë¡í•´ ë†“ì•„ì•¼ í•©ë‹ˆë‹¤.\nsqueueë‚˜ smap -ië¡œ ì‘ì—… í˜„í™©ì„ í™•ì¸í•˜ê³ , cat xxx.logì´ë‚˜ tail -f xxx.errìœ¼ë¡œ ì½˜ì†” ì¶œë ¥ì´ë‚˜ errorë¥¼ í™•ì¸í•©ë‹ˆë‹¤.\n1 2 3 4  sbatch tensor.job smap -i 1 # ì‘ì—… í˜„í™©ì„ 1ì´ˆë§ˆë‹¤ ê°±ì‹ í•˜ì—¬ ë³´ì—¬ì¤ë‹ˆë‹¤. ctrl+cë¡œ escape í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. cat tensor.log tail -f tensor.err   ë¡œê·¸ íŒŒì¼ì— ì½˜ì†” ì•„ì›ƒí’‹ì´ ê¸°ë¡ë©ë‹ˆë‹¤.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  2022-03-15 14:27:34.877232: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags. 2022-03-15 14:27:34.887611: I tensorflow/core/common_runtime/process_util.cc:146] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance. 2022-03-15 14:27:38.063857: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185] None of the MLIR Optimization Passes are enabled (registered 2) Epoch 1/5 1875/1875 [==============================] - 36s 19ms/step - loss: 0.2993 - accuracy: 0.9140 Epoch 2/5 1875/1875 [==============================] - 18s 10ms/step - loss: 0.1436 - accuracy: 0.9575 Epoch 3/5 1875/1875 [==============================] - 17s 9ms/step - loss: 0.1080 - accuracy: 0.9675 Epoch 4/5 1875/1875 [==============================] - 19s 10ms/step - loss: 0.0866 - accuracy: 0.9739 Epoch 5/5 1875/1875 [==============================] - 52s 28ms/step - loss: 0.0750 - accuracy: 0.9762 313/313 - 4s - loss: 0.0782 - accuracy: 0.9779 [0.078231580555439, 0.9779000282287598]   ë” ì•Œì•„ë³´ê¸° Submitting a slurm job script\nSLRUM Job Examples\nTensorFlow on the HPC Clusters\n",
  "wordCount" : "1431",
  "inLanguage": "en",
  "datePublished": "2022-03-17T14:54:35+09:00",
  "dateModified": "2022-03-17T14:54:35+09:00",
  "author":{
    "@type": "Person",
    "name": "Gwnaghee Kim, Jongmin Mun"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hpc.stat.yonsei.ac.kr/docs/how-to-use-gpu-node-for-slurm/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Chili Pepper",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hpc.stat.yonsei.ac.kr/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hpc.stat.yonsei.ac.kr" accesskey="h" title="Chili Pepper (Alt + H)">Chili Pepper</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hpc.stat.yonsei.ac.kr/docs/" title="Docs">
                    <span>Docs</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://hpc.stat.yonsei.ac.kr">Home</a>&nbsp;Â»&nbsp;<a href="https://hpc.stat.yonsei.ac.kr/docs/">Docs</a></div>
    <h1 class="post-title">
      4. GPU node ì‚¬ìš©ë²•(Python)
    </h1>
    <div class="post-meta"><span title='2022-03-17 14:54:35 +0900 +0900'>March 17, 2022</span>&nbsp;Â·&nbsp;7 min&nbsp;Â·&nbsp;Gwnaghee Kim, Jongmin Mun

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#4-gpu-node-%ec%82%ac%ec%9a%a9%eb%b2%95python" aria-label="4. GPU node ì‚¬ìš©ë²•(Python)">4. GPU node ì‚¬ìš©ë²•(Python)</a><ul>
                        
                <li>
                    <a href="#step-4-export-your-conda-setting" aria-label="Step 4. Export your conda setting">Step 4. Export your conda setting</a><ul>
                        
                <li>
                    <a href="#%eb%b2%84%ec%a0%84-%ea%b4%80%eb%a6%ac" aria-label="ë²„ì „ ê´€ë¦¬">ë²„ì „ ê´€ë¦¬</a></li>
                <li>
                    <a href="#1-local%ec%97%90%ec%84%9c-conda-environment-%ec%83%9d%ec%84%b1" aria-label="1. localì—ì„œ conda environment ìƒì„±">1. localì—ì„œ conda environment ìƒì„±</a></li>
                <li>
                    <a href="#2-gpu-compute-node%ec%97%90%ec%84%9c-%eb%8f%99%ec%9d%bc%ed%95%9c-conda-environment-%ea%b5%ac%ec%b6%95" aria-label="2. GPU-compute nodeì—ì„œ ë™ì¼í•œ conda environment êµ¬ì¶•">2. GPU-compute nodeì—ì„œ ë™ì¼í•œ conda environment êµ¬ì¶•</a><ul>
                        
                <li>
                    <a href="#21-%ec%a4%91%ec%9a%94-%ed%8c%a8%ed%82%a4%ec%a7%80%ec%9d%98-%eb%b2%84%ec%a0%84%eb%a7%8c-%eb%a7%9e%ec%b6%94%ea%b8%b0" aria-label="2.1. ì¤‘ìš” íŒ¨í‚¤ì§€ì˜ ë²„ì „ë§Œ ë§ì¶”ê¸°">2.1. ì¤‘ìš” íŒ¨í‚¤ì§€ì˜ ë²„ì „ë§Œ ë§ì¶”ê¸°</a></li>
                <li>
                    <a href="#22-local-environment-export%ed%95%98%ea%b8%b0" aria-label="2.2. local environment exportí•˜ê¸°">2.2. local environment exportí•˜ê¸°</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#step-5-slrum-batch-script-%ec%9e%91%ec%84%b1%ed%95%98%ec%97%ac-%ec%84%9c%eb%b2%84%ec%97%90-%ec%a0%9c%ec%b6%9c%ed%95%98%ea%b8%b0" aria-label="Step 5. Slrum batch script ì‘ì„±í•˜ì—¬ ì„œë²„ì— ì œì¶œí•˜ê¸°">Step 5. Slrum batch script ì‘ì„±í•˜ì—¬ ì„œë²„ì— ì œì¶œí•˜ê¸°</a><ul>
                        
                <li>
                    <a href="#1-python-%ec%bd%94%eb%93%9c-%ec%9e%91%ec%84%b1" aria-label="1. Python ì½”ë“œ ì‘ì„±">1. Python ì½”ë“œ ì‘ì„±</a></li>
                <li>
                    <a href="#2-%ed%98%84%ec%9e%ac-%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%ec%9e%90%ec%9b%90-%ec%82%ac%ec%9a%a9%eb%9f%89-%ed%99%95%ec%9d%b8" aria-label="2. í˜„ì¬ í´ëŸ¬ìŠ¤í„° ìì› ì‚¬ìš©ëŸ‰ í™•ì¸">2. í˜„ì¬ í´ëŸ¬ìŠ¤í„° ìì› ì‚¬ìš©ëŸ‰ í™•ì¸</a></li>
                <li>
                    <a href="#3-slurm-batch-script-%ec%9e%91%ec%84%b1" aria-label="3. Slurm batch script ì‘ì„±">3. Slurm batch script ì‘ì„±</a></li>
                <li>
                    <a href="#4-slurm-batch-script-%ec%8b%a4%ed%96%89" aria-label="4. Slurm batch script ì‹¤í–‰">4. Slurm batch script ì‹¤í–‰</a></li></ul>
                </li>
                <li>
                    <a href="#%eb%8d%94-%ec%95%8c%ec%95%84%eb%b3%b4%ea%b8%b0" aria-label="ë” ì•Œì•„ë³´ê¸°">ë” ì•Œì•„ë³´ê¸°</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="4-gpu-node-ì‚¬ìš©ë²•python">4. GPU node ì‚¬ìš©ë²•(Python)<a hidden class="anchor" aria-hidden="true" href="#4-gpu-node-ì‚¬ìš©ë²•python">#</a></h1>
<p>2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ë¥¼ ë¨¼ì € ìˆ™ì§€í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤. ì´ ë¬¸ì„œëŠ” 2ë²ˆ ë¬¸ì„œì˜ Step 1, 2, 3 ì´í›„ì˜ ë‚´ìš©ë§Œì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
<p><code>GPU-compute</code> nodeì—ì„œëŠ” <code>Python</code>ë§Œ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
<h2 id="step-4-export-your-conda-setting">Step 4. Export your conda setting<a hidden class="anchor" aria-hidden="true" href="#step-4-export-your-conda-setting">#</a></h2>
<h3 id="ë²„ì „-ê´€ë¦¬">ë²„ì „ ê´€ë¦¬<a hidden class="anchor" aria-hidden="true" href="#ë²„ì „-ê´€ë¦¬">#</a></h3>
<p>ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” ë²„ì „ ê´€ë¦¬ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.</p>
<ul>
<li>GPU ë“œë¼ì´ë²„ ë²„ì „(<code>418.67</code>)</li>
<li>Python ë²„ì „</li>
<li>CUDA ë²„ì „(<a href="https://docs.nvidia.com/cuda/cuda-toolkit-release-notes/index.html">í˜¸í™˜ì„± í‘œ</a>)</li>
<li>cuDNN, ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬(<code>tensorflow</code>, <code>pytorch</code>) ë²„ì „(í˜¸í™˜ì„± í‘œ: <a href="https://www.tensorflow.org/install/source#gpu">tensorflow</a>, <a href="https://pytorch.org/get-started/previous-versions/">pytorch</a>)</li>
</ul>
<p>ì´ë“¤ì˜ ë²„ì „ ê°„ í˜¸í™˜ì´ ë˜ëŠ” ì¡°í•©ì„ ìˆ™ì§€í•˜ê³  ì´ì— ë”°ë¼ conda environmentë¥¼ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤. <code>GPU-compute</code> nodeì˜ GPU ë“œë¼ì´ë²„ ë²„ì „ì€ <code>418.67</code>ìœ¼ë¡œ ê³ ì •ë˜ì–´ ìˆì§€ë§Œ, ë‚˜ë¨¸ì§€ ë²„ì „ì€ conda environmentë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¨, <code>Python</code> ë²„ì „ì˜ ê²½ìš° <code>gpu-compute</code> nodeì—ëŠ” conda version 4.6.14ê°€ ì„¤ì¹˜ë˜ì–´ ìˆìœ¼ë¯€ë¡œ 3.8ê¹Œì§€ë§Œ ì§€ì›í•©ë‹ˆë‹¤.</p>
<p>GPU ë“œë¼ì´ë²„ ë²„ì „(<code>418.67</code>)ì— ë§ëŠ” Python ë²„ì „ê³¼ ë”¥ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì„ ì •í•œ ë‹¤ìŒ conda create ëª…ë ¹ì–´ì—ì„œ ë²„ì „ì„ ëª…ì‹œí•´ ì£¼ë©´ ì•Œì•„ì„œ CUDAì™€ cuDNN ë²„ì „ì„ ë§ì¶° ì¤ë‹ˆë‹¤. ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ì´ ë°©ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>
<p>ì´ íŠœí† ë¦¬ì–¼ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë²„ì „ì€ <code>tensorflow-gpu-2.2.0</code>ì…ë‹ˆë‹¤.</p>
<h3 id="1-localì—ì„œ-conda-environment-ìƒì„±">1. localì—ì„œ conda environment ìƒì„±<a hidden class="anchor" aria-hidden="true" href="#1-localì—ì„œ-conda-environment-ìƒì„±">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">conda create -n testEnvGPU <span class="nv">python</span><span class="o">=</span>3.7
</code></pre></td></tr></table>
</div>
</div><p>ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ë©´ ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span class="lnt" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span class="lnt" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span class="lnt" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span class="lnt" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text">Preparing transaction: done
Verifying transaction: done
Executing transaction: done
#
# To activate this environment, use
#
#     $ conda activate testEnv
#
# To deactivate an active environment, use
#
#     $ conda deactivate
</code></pre></td></tr></table>
</div>
</div><p>ì•„ë˜ ì»¤ë§¨ë“œë¥¼ í†µí•´ virtual environmentê°€ ì œëŒ€ë¡œ ìƒì„±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">conda info --env
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"># conda environments:
#
base                  *  /opt/miniconda3
testEnvGPU               /opt/miniconda3/envs/testEnvGPU
</code></pre></td></tr></table>
</div>
</div><p>Virtual environmentì— ì§„ì…í•œ ë’¤ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.</p>
<ul>
<li>pipë¡œ ì„¤ì¹˜ë˜ëŠ” íŒ¨í‚¤ì§€ë“¤ì€ condaë¡œ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ì— ëŒ€í•œ ì •ë³´ë¥¼ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì˜ì¡´ì„± ì¶©ëŒì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ condaë§Œì„ ì‚¬ìš©í•´ì„œ ì„¤ì¹˜í•˜ì‹¤ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.</li>
<li><a href="https://anaconda.org/anaconda/scikit-learn">anaconda ì›¹ì‚¬ì´íŠ¸</a>ì—ì„œ íŒ¨í‚¤ì§€ëª…ì„ ê²€ìƒ‰í•´ì„œ linux-64ë¥¼ ì§€ì›í•˜ëŠ” ë²„ì „ì´ ì–´ë””ê¹Œì§€ì¸ì§€ë¥¼ í™•ì¸í•˜ê³  ì„¤ì¹˜í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤. ì´ ì‚¬ì´íŠ¸ëŠ” ì„¤ì¹˜ ì»¤ë§¨ë“œë„ ì œê³µí•©ë‹ˆë‹¤.</li>
<li>ì—¬ëŸ¬ íŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•  ê²½ìš° í•œ ì»¤ë§¨ë“œ ë‚´ì— ëª…ì‹œí•˜ë©´ condaê°€ ìë™ìœ¼ë¡œ dependency ì¶©ëŒì„ ê²€ì‚¬í•´ ì¤ë‹ˆë‹¤.</li>
<li>íŒ¨í‚¤ì§€ ë²„ì „ì„ ëª…ì‹œí•  ë•ŒëŠ” **=**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">conda activate testEnvGPU

<span class="c1">#For example,</span>
conda install -c anaconda tensorflow-gpu<span class="o">=</span>2.2.0 cudatoolkit cudnn matplotlib scikit-learn pandas numpy
</code></pre></td></tr></table>
</div>
</div><p>ì•„ë˜ ëª…ë ¹ì–´ë¡œ cudatoolkit, cudnn ë²„ì „ì„ í™•ì¸í•˜ì—¬ batch</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">conda list
</code></pre></td></tr></table>
</div>
</div><h3 id="2-gpu-compute-nodeì—ì„œ-ë™ì¼í•œ-conda-environment-êµ¬ì¶•">2. GPU-compute nodeì—ì„œ ë™ì¼í•œ conda environment êµ¬ì¶•<a hidden class="anchor" aria-hidden="true" href="#2-gpu-compute-nodeì—ì„œ-ë™ì¼í•œ-conda-environment-êµ¬ì¶•">#</a></h3>
<h4 id="21-ì¤‘ìš”-íŒ¨í‚¤ì§€ì˜-ë²„ì „ë§Œ-ë§ì¶”ê¸°">2.1. ì¤‘ìš” íŒ¨í‚¤ì§€ì˜ ë²„ì „ë§Œ ë§ì¶”ê¸°<a hidden class="anchor" aria-hidden="true" href="#21-ì¤‘ìš”-íŒ¨í‚¤ì§€ì˜-ë²„ì „ë§Œ-ë§ì¶”ê¸°">#</a></h4>
<p>2ë²ˆ ë¬¸ì„œ(CPU node ì‚¬ìš©ë²•(Python))ì—ì„œ í•œ ê²ƒì²˜ëŸ¼ tensorflow ë“±ì˜ ë²„ì „ë§Œ ë™ì¼í•˜ê²Œ í•˜ì—¬ <code>GPU-compute</code> nodeì—ì„œ <code>conda create</code>ë¡œ conda environmentë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>ì´ ë°©ë²•ì€ 2ë²ˆ ë¬¸ì„œì˜ ì•ˆë‚´ë¥¼ ë”°ë¼ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ ì„¤ëª…ì„ ìƒëµí•˜ê³  sbatch scriptë§Œ ì œì‹œí•©ë‹ˆë‹¤.</li>
<li>Slurm job configuratorì—ì„œ <code>Using GPU</code>ì— ì²´í¬í•œë‹¤ëŠ” ì ë§Œ ë‹¤ë¦…ë‹ˆë‹¤.</li>
<li>ì´ íŠœí† ë¦¬ì–¼ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë²„ì „ì€ <code>tensorflow-gpu-2.2.0</code>ì…ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span class="lnt" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span class="lnt" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span class="lnt" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span class="lnt" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span class="lnt" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span class="lnt" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span class="lnt" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span class="lnt" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">   <span class="c1">#!/bin/bash</span>
   <span class="c1">#SBATCH --job-name=conda-env-create</span>
   <span class="c1">#SBATCH --nodes=1</span>
   <span class="c1">#SBATCH --mem=4gb</span>
   <span class="c1">#SBATCH --partition=all</span>
   <span class="c1">#SBATCH --nodelist=gpu-compute</span>
   <span class="c1">#SBATCH --output=testEnvGPU.log</span>
   <span class="c1">#SBATCH --error=testEnvGPU.err</span>
   <span class="nv">CONDA_BIN_PATH</span><span class="o">=</span>/opt/miniconda/bin
   <span class="nv">ENV_NAME</span><span class="o">=</span>testEnvGPU <span class="c1">#localì—ì„œì™€ ê°™ì€ ì´ë¦„ìœ¼ë¡œ ì…ë ¥</span>
   <span class="nv">ENV_PATH</span><span class="o">=</span>/mnt/nas/users/<span class="k">$(</span>whoami<span class="k">)</span>/.conda/envs/<span class="nv">$ENV_NAME</span>
   <span class="nv">$CONDA_BIN_PATH</span>/conda env remove --prefix <span class="nv">$ENV_PATH</span>
   <span class="nv">$CONDA_BIN_PATH</span>/conda create -y --prefix <span class="nv">$ENV_PATH</span> <span class="nv">python</span><span class="o">=</span>3.7
   <span class="nb">source</span> <span class="nv">$CONDA_BIN_PATH</span>/activate <span class="nv">$ENV_PATH</span>
   conda install tensorflow-gpu<span class="o">=</span>2.2.0
</code></pre></td></tr></table>
</div>
</div><h4 id="22-local-environment-exportí•˜ê¸°">2.2. local environment exportí•˜ê¸°<a hidden class="anchor" aria-hidden="true" href="#22-local-environment-exportí•˜ê¸°">#</a></h4>
<p>Localì—ì„œ ìƒì„±ëœ ê°€ìƒí™˜ê²½ìœ¼ë¡œë¶€í„° í™˜ê²½ì„¤ì • <code>yml</code> íŒŒì¼ì„ ë§Œë“¤ê³ , ì´ë¥¼ ì´ìš©í•´ <code>GPU-compute</code> nodeì—ì„œ conda environmentë¥¼ ìƒì„±í•˜ì—¬ conda í™˜ê²½ì„ ë™ì¼í•˜ê²Œ ë§ì¶œ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì´ê²Œ ê°€ì¥ ì´ìƒì ì¸ ë°©ë²•ì´ì§€ë§Œ, local OSê°€ linuxê°€ ì•„ë‹ ê²½ìš° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì„œì—ì„œëŠ” ì´ ë°©ë²•ì„ ì„¤ëª…í•©ë‹ˆë‹¤.</p>
<p>Localì—ì„œ ì•„ë˜ ì»¤ë§¨ë“œë¡œ <code>yml</code> íŒŒì¼ì„ ì¶”ì¶œí•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># export conda setting</span>
conda activate <span class="o">[</span>YOUR ENV NAME<span class="o">]</span>
conda env <span class="nb">export</span> -n <span class="o">[</span>ENV NAME<span class="o">]</span> -f <span class="o">[</span>FILENAME<span class="o">]</span>.yml --no-builds <span class="c1"># ì´ëŸ¬ë©´ ë¬¸ì œê°€ í•´ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
</code></pre></td></tr></table>
</div>
</div><p><code>yml</code> íŒŒì¼ì„ í´ëŸ¬ìŠ¤í„° ë‚´ user home directoryë¡œ ì˜®ê¸°ê³  ì•„ë˜ ì»¤ë§¨ë“œë¥¼ slurm job scriptì— ì¶”ê°€í•˜ê³  sbatchë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤. ì´ ë•Œ Slurm job configuratorì—ì„œ <code>Using GPU</code>ì— ì²´í¬í•´ì•¼ í•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">6</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># create environment from file</span>

conda create --name <span class="o">[</span>YOUR ENV NAME<span class="o">]</span> <span class="nv">python</span> <span class="o">=</span> <span class="o">[</span>VESTION<span class="o">]</span> <span class="c1"># same env name in yml file</span>
conda env create -f <span class="o">[</span>FILENAME<span class="o">]</span>.yml

conda env create -p <span class="o">[</span>prefix path<span class="o">]</span> -f <span class="o">[</span>filename<span class="o">]</span>.yml
</code></pre></td></tr></table>
</div>
</div><p><strong>â€”no-builds</strong> ì˜µì…˜ì€ ì„œë¡œ ë‹¤ë¥¸ OSì—ì„œ conda environment ë‚´ íŒ¨í‚¤ì§€ë“¤ì˜ ë²„ì „ ì¶©ëŒì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ê²ƒì…ë‹ˆë‹¤. ì´ ì˜µì…˜ë§Œìœ¼ë¡œ ë¬¸ì œê°€ í•´ê²°ë˜ê¸°ë„ í•˜ì§€ë§Œ, í•´ê²°ë˜ì§€ ì•Šìœ¼ë©´ userê°€ ì§ì ‘ <code>yml</code> íŒŒì¼ì„ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤. ì—ëŸ¬ ë©”ì‹œì§€ì— <strong>ResolvePackageNotFound</strong>ë¼ëŠ” ë¬¸êµ¬ê°€ ë‚˜ì˜¤ëŠ”ë°, ì´ ë¬¸êµ¬ ì•„ë˜ì˜ íŒ¨í‚¤ì§€ë“¤ì„ <code>yml</code> íŒŒì¼ì—ì„œ ì‚­ì œí•´ì£¼ë©´ ë¬¸ì œê°€ í•´ê²°ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span class="lnt" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span class="lnt" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span class="lnt" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span class="lnt" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span class="lnt" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span class="lnt" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span class="lnt" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span class="lnt" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span class="lnt" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span class="lnt" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span class="lnt" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span class="lnt" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">conda env create -f test.yml
Collecting package metadata: <span class="k">done</span>
Solving environment: failed

<span class="c1"># yml íŒŒì¼ì—ì„œ ì•„ë˜ì— ë“±ì¥í•˜ëŠ” íŒ¨í‚¤ì§€ë“¤ì„ ì§€ì›Œì¤ë‹ˆë‹¤.</span>
ResolvePackageNotFound: 
  - <span class="nv">libgfortran</span><span class="o">==</span>3.0.1<span class="o">=</span>h93005f0_2 <span class="c1"># --no-builds ì˜µì…˜ì„ ì“°ë©´ íŒ¨í‚¤ì§€ ë²„ì „ ì˜†ì˜ ë¹Œë“œ ì •ë³´ê°€ ë‚˜ì˜¤ì§€ ì•ŠìŠµë‹ˆë‹¤.</span>
  - <span class="nv">pyzmq</span><span class="o">==</span>17.0.0<span class="o">=</span>py36h1de35cc_1
  - <span class="nv">python</span><span class="o">==</span>3.6.6<span class="o">=</span>h4a56312_1003
  - <span class="nv">prompt_toolkit</span><span class="o">==</span>1.0.15<span class="o">=</span>py36haeda067_0
  - <span class="nv">libiconv</span><span class="o">==</span>1.15<span class="o">=</span>h1de35cc_1004
  - <span class="nv">sqlite</span><span class="o">==</span>3.25.3<span class="o">=</span>ha441bb4_0
  - <span class="nv">six</span><span class="o">==</span>1.11.0<span class="o">=</span>py36h0e22d5e_1
  - <span class="nv">cryptography</span><span class="o">==</span>2.3.1<span class="o">=</span>py36hdbc3d79_1000
  - <span class="nv">openssl</span><span class="o">==</span>1.0.2p<span class="o">=</span>h1de35cc_1002
  - <span class="nv">libxml2</span><span class="o">==</span>2.9.8<span class="o">=</span>hf14e9c8_1005
  - <span class="nv">libcxxabi</span><span class="o">==</span>4.0.1<span class="o">=</span>hebd6815_0
  - <span class="nv">matplotlib</span><span class="o">==</span>2.2.3<span class="o">=</span>py36h0e0179f_0
  - <span class="nv">ptyprocess</span><span class="o">==</span>0.5.2<span class="o">=</span>py36he6521c3_0
</code></pre></td></tr></table>
</div>
</div><aside>
ğŸ’¡ `yml` fileì„ ì´ìš©í•œ conda í™˜ê²½ ì„¤ì •ì€ ë¡œì»¬ê³¼ ì„œë²„ ì‘ì—… í™˜ê²½ì„ ë™ì¼í•˜ê²Œ ì„¤ì •í•  ìˆ˜ ìˆëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ì§€ë§Œ, conda í™˜ê²½ ì„¤ì • ê³¼ì •ì´ ë„ˆë¬´ ë²ˆê±°ë¡­ë‹¤ë©´ requirements.txtë¥¼ ë§Œë“¤ì–´ íŒ¨í‚¤ì§€ ë²„ì „ë§Œ ê´€ë¦¬í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
</aside>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5">5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6">6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7">7</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">conda install --force-reinstall -y -q -c conda-forge --file requirements.txt

<span class="c1"># --force-reinstall : Install the package even if it already exists.</span>
<span class="c1"># -y : Yes, do not ask for confirmation.</span>
<span class="c1"># -q : Quiet, do not display progress bar.</span>
<span class="c1"># -c : Channels, additional channels to search for packages</span>
<span class="c1"># conda-forge is recommended</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="step-5-slrum-batch-script-ì‘ì„±í•˜ì—¬-ì„œë²„ì—-ì œì¶œí•˜ê¸°">Step 5. Slrum batch script ì‘ì„±í•˜ì—¬ ì„œë²„ì— ì œì¶œí•˜ê¸°<a hidden class="anchor" aria-hidden="true" href="#step-5-slrum-batch-script-ì‘ì„±í•˜ì—¬-ì„œë²„ì—-ì œì¶œí•˜ê¸°">#</a></h2>
<h3 id="1-python-ì½”ë“œ-ì‘ì„±">1. Python ì½”ë“œ ì‘ì„±<a hidden class="anchor" aria-hidden="true" href="#1-python-ì½”ë“œ-ì‘ì„±">#</a></h3>
<p>ì´ì œ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì‹¤í–‰í•  Python ì½”ë“œë¥¼ localì—ì„œ ì‘ì„±í•©ë‹ˆë‹¤. ë¨¼ì € localì—ì„œ ì½”ë“œê°€ ì˜¤ë¥˜ ì—†ì´ ëŒì•„ê°€ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤. ê·¸ í›„ í´ëŸ¬ìŠ¤í„°ì˜ user home directoryì— ì˜®ê¸°ê±°ë‚˜, <code>Visual Studio Code</code>ë‚´ì—ì„œ ì‘ì„±í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤.</p>
<p>ì•„ë˜ëŠ” TensorFlow ê³µì‹ í˜ì´ì§€ì— ê²Œì‹œëœ <a href="https://www.tensorflow.org/tutorials/quickstart/beginner?hl=ko">ì´ˆë³´ììš© íŠœí† ë¦¬ì–¼</a> ì½”ë“œì…ë‹ˆë‹¤. Batch scriptë¥¼ ì‘ì„±í•  ë•ŒëŠ” ì•Œê³ ë¦¬ì¦˜ì˜ outputì´ ìë™ìœ¼ë¡œ ì €ì¥ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ íŒŒì¼ë¡œ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ì½”ë“œë¥¼ í¬í•¨í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œì—ëŠ” ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ì½”ë“œëŠ” ì—†ì§€ë§Œ, **model.evaluate(x_test,  y_test, verbose=2)**ê°€ ê²°ê³¼ë¥¼ ì½˜ì†”ì— ì¶œë ¥í•˜ê¸° ë•Œë¬¸ì— ë¡œê·¸ íŒŒì¼ì—ì„œ ê²°ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ ì½”ë“œë¥¼ <code>tensor.py</code>ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ user home directoryì— ì €ì¥í•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span class="lnt" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span class="lnt" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span class="lnt" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span class="lnt" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span class="lnt" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span class="lnt" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span class="lnt" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span class="lnt" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span class="lnt" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span class="lnt" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span class="lnt" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span class="lnt" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span class="lnt" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span><span class="lnt" id="21"><a style="outline: none; text-decoration:none; color:inherit" href="#21">21</a>
</span><span class="lnt" id="22"><a style="outline: none; text-decoration:none; color:inherit" href="#22">22</a>
</span><span class="lnt" id="23"><a style="outline: none; text-decoration:none; color:inherit" href="#23">23</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1"># tensor.py</span>

<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="n">mnist</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">mnist</span>

<span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>
<span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">=</span> <span class="n">x_train</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="n">x_test</span> <span class="o">/</span> <span class="mf">255.0</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
  <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span>
  <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;relu&#39;</span><span class="p">),</span>
  <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
  <span class="n">tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;softmax&#39;</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">&#39;adam&#39;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s1">&#39;sparse_categorical_crossentropy&#39;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span>  <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="2-í˜„ì¬-í´ëŸ¬ìŠ¤í„°-ìì›-ì‚¬ìš©ëŸ‰-í™•ì¸">2. í˜„ì¬ í´ëŸ¬ìŠ¤í„° ìì› ì‚¬ìš©ëŸ‰ í™•ì¸<a hidden class="anchor" aria-hidden="true" href="#2-í˜„ì¬-í´ëŸ¬ìŠ¤í„°-ìì›-ì‚¬ìš©ëŸ‰-í™•ì¸">#</a></h3>
<p>ì•„ë˜ ì»¤ë§¨ë“œë¥¼ í†µí•´ <code>cpu-compute</code> ë…¸ë“œì˜ cpuì™€ RAM ì‚¬ìš© í˜„í™©ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">sinfo -o <span class="s2">&#34;%n %e %m %a %c %C&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p>ì•„ë˜ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜µë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">HOSTNAMES FREE_MEM MEMORY AVAIL CPUS CPUS(A/I/O/T)
cpu-compute 105589 128916 up 32 0/32/0/32
gpu-compute 53318 80532 up 16 0/16/0/16
</code></pre></td></tr></table>
</div>
</div><ul>
<li>CPUSì˜ A/I/O/TëŠ” allocated/idle/other/totalì„ ì˜ë¯¸í•©ë‹ˆë‹¤.</li>
<li>ìì‹ ì˜ jobì´ ë°”ë¡œ ì‹¤í–‰ë˜ê¸°ë¥¼ ì›í•œë‹¤ë©´, Slurm batch scriptë¥¼ ì‘ì„±í•  ë•Œ
<ul>
<li>RAM ìš©ëŸ‰ì„ FREE_MEMë³´ë‹¤ ì ê²Œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</li>
<li>CPU ì½”ì–´ ê°œìˆ˜ë¥¼ CPUS idleë³´ë‹¤ ì ê²Œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.</li>
</ul>
</li>
<li>í˜„ì¬ ê°€ìš© ìì›ë³´ë‹¤ ë” ë§ì€ ìì›ì„ ìš”êµ¬í•˜ëŠ” scriptë¥¼ ì‘ì„±í•˜ë©´, jobì´ ë°”ë¡œ ì‹¤í–‰ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ê¸° ìƒíƒœì— ìˆë‹¤ê°€ ë‹¤ë¥¸ ì‚¬ìš©ìë“¤ì˜ jobì´ ëë‚˜ê³  ìì›ì´ ë°˜í™˜ë˜ë©´ jobì´ ì‹¤í–‰ë©ë‹ˆë‹¤.</li>
</ul>
<h3 id="3-slurm-batch-script-ì‘ì„±">3. Slurm batch script ì‘ì„±<a hidden class="anchor" aria-hidden="true" href="#3-slurm-batch-script-ì‘ì„±">#</a></h3>
<p>ì•ì„  ë‹¨ê³„ì—ì„œ ë§Œë“  í•´ë‹¹ conda environmentë¥¼ activateí•˜ê³  ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” Slurm batch scriptë¥¼ ì‘ì„±í•©ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„° ì†Œê°œ í˜ì´ì§€ì˜ <a href="https://hpc.stat.yonsei.ac.kr/tools/job-configurator.html">slurm job configurator</a>ë¥¼ ì‚¬ìš©í•˜ë©´ scriptë¥¼ ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<p><img loading="lazy" src="/img/slurm_config.png" alt="slurm_config"  />
</p>
<ul>
<li>Conda activateì— ì²´í¬í•©ë‹ˆë‹¤.</li>
<li>Using GPUì— ì²´í¬í•©ë‹ˆë‹¤.</li>
<li>ë¹ˆì¹¸ë“¤ì„ ì±„ì›ë‹ˆë‹¤.</li>
<li>Scriptë€ì— <strong>python xxx.py</strong>ë¼ê³  ì‘ì„±í•©ë‹ˆë‹¤. ì´ëŠ” home directoryì— ìˆëŠ” <strong>xxx.py</strong> íŒŒì¼ì„ Pythonìœ¼ë¡œ ì‹¤í–‰í•˜ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</li>
<li><strong>Print &amp; Copy</strong> ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ë‚´ìš©ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë©ë‹ˆë‹¤.</li>
</ul>
<p>ì´ ë¬¸ì„œì—ì„œ ì‚¬ìš©í•œ Slurm batch scriptì˜ ë‚´ìš©ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span class="lnt" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span class="lnt" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span class="lnt" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span class="lnt" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span class="lnt" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span class="lnt" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span class="lnt" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span class="lnt" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span class="lnt" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span><span class="lnt" id="17"><a style="outline: none; text-decoration:none; color:inherit" href="#17">17</a>
</span><span class="lnt" id="18"><a style="outline: none; text-decoration:none; color:inherit" href="#18">18</a>
</span><span class="lnt" id="19"><a style="outline: none; text-decoration:none; color:inherit" href="#19">19</a>
</span><span class="lnt" id="20"><a style="outline: none; text-decoration:none; color:inherit" href="#20">20</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash 
</span><span class="cp"></span><span class="c1">#</span>
<span class="c1">#SBATCH --job-name=tensor</span>
<span class="c1">#SBATCH --partition=all</span>
<span class="c1">#SBATCH --account=mjm</span>
<span class="c1">#SBATCH --mem=16gb</span>
<span class="c1">#SBATCH --ntasks=1</span>
<span class="c1">#SBATCH --cpus-per-task=8</span>
<span class="c1">#SBATCH --time=00:30:00</span>
<span class="c1">#SBATCH --output=/mnt/nas/users/mjm/tensor.log</span>
<span class="c1">#SBATCH --error=/mnt/nas/users/mjm/tensor.err</span>
<span class="c1">#SBATCH --gres=gpu:1</span>
<span class="c1">#SBATCH --nodelist=gpu-compute</span>

<span class="nv">CONDA_BIN_PATH</span><span class="o">=</span>/opt/miniconda/bin
<span class="nv">ENV_NAME</span><span class="o">=</span>testEnvGPU
<span class="nv">ENV_PATH</span><span class="o">=</span>/mnt/nas/users/<span class="k">$(</span>whoami<span class="k">)</span>/.conda/envs/<span class="nv">$ENV_NAME</span>
<span class="nb">source</span> <span class="nv">$CONDA_BIN_PATH</span>/activate <span class="nv">$ENV_PATH</span>

python tensor.py
</code></pre></td></tr></table>
</div>
</div><p><code>tensor.job</code>ì´ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ì˜ user home directoryì— ì €ì¥í•©ë‹ˆë‹¤.</p>
<p>sbatchì— ëŒ€í•œ ë” ìì„¸í•œ ì •ë³´ëŠ” <a href="https://slurm.schedmd.com/sbatch.html">Slurm ê³µì‹ ì›¹í˜ì´ì§€</a>ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.</p>
<h3 id="4-slurm-batch-script-ì‹¤í–‰">4. Slurm batch script ì‹¤í–‰<a hidden class="anchor" aria-hidden="true" href="#4-slurm-batch-script-ì‹¤í–‰">#</a></h3>
<p>Conda environmentë¥¼ ë§Œë“¤ ë•Œì²˜ëŸ¼, <strong>sbatch</strong> ì»¤ë§¨ë“œë¥¼ í†µí•´ jobì„ ì œì¶œí•©ë‹ˆë‹¤. í• ë‹¹ë˜ëŠ” job ë²ˆí˜¸ëŠ” ë‚˜ì¤‘ì— job ì •ë³´ë¥¼ í™•ì¸í•˜ê±°ë‚˜ jobì„ ì·¨ì†Œí•  ë•Œ ì´ìš©ë˜ë¯€ë¡œ ê¸°ë¡í•´ ë†“ì•„ì•¼ í•©ë‹ˆë‹¤.</p>
<p><strong>squeue</strong>ë‚˜ <strong>smap -i</strong>ë¡œ ì‘ì—… í˜„í™©ì„ í™•ì¸í•˜ê³ , <strong>cat xxx.log</strong>ì´ë‚˜ <strong>tail -f xxx.err</strong>ìœ¼ë¡œ ì½˜ì†” ì¶œë ¥ì´ë‚˜ errorë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1">1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2">2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3">3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4">4</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">sbatch tensor.job
smap -i <span class="m">1</span> <span class="c1"># ì‘ì—… í˜„í™©ì„ 1ì´ˆë§ˆë‹¤ ê°±ì‹ í•˜ì—¬ ë³´ì—¬ì¤ë‹ˆë‹¤. ctrl+cë¡œ escape í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</span>
cat tensor.log
tail -f tensor.err
</code></pre></td></tr></table>
</div>
</div><p>ë¡œê·¸ íŒŒì¼ì— ì½˜ì†” ì•„ì›ƒí’‹ì´ ê¸°ë¡ë©ë‹ˆë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt" id="1"><a style="outline: none; text-decoration:none; color:inherit" href="#1"> 1</a>
</span><span class="lnt" id="2"><a style="outline: none; text-decoration:none; color:inherit" href="#2"> 2</a>
</span><span class="lnt" id="3"><a style="outline: none; text-decoration:none; color:inherit" href="#3"> 3</a>
</span><span class="lnt" id="4"><a style="outline: none; text-decoration:none; color:inherit" href="#4"> 4</a>
</span><span class="lnt" id="5"><a style="outline: none; text-decoration:none; color:inherit" href="#5"> 5</a>
</span><span class="lnt" id="6"><a style="outline: none; text-decoration:none; color:inherit" href="#6"> 6</a>
</span><span class="lnt" id="7"><a style="outline: none; text-decoration:none; color:inherit" href="#7"> 7</a>
</span><span class="lnt" id="8"><a style="outline: none; text-decoration:none; color:inherit" href="#8"> 8</a>
</span><span class="lnt" id="9"><a style="outline: none; text-decoration:none; color:inherit" href="#9"> 9</a>
</span><span class="lnt" id="10"><a style="outline: none; text-decoration:none; color:inherit" href="#10">10</a>
</span><span class="lnt" id="11"><a style="outline: none; text-decoration:none; color:inherit" href="#11">11</a>
</span><span class="lnt" id="12"><a style="outline: none; text-decoration:none; color:inherit" href="#12">12</a>
</span><span class="lnt" id="13"><a style="outline: none; text-decoration:none; color:inherit" href="#13">13</a>
</span><span class="lnt" id="14"><a style="outline: none; text-decoration:none; color:inherit" href="#14">14</a>
</span><span class="lnt" id="15"><a style="outline: none; text-decoration:none; color:inherit" href="#15">15</a>
</span><span class="lnt" id="16"><a style="outline: none; text-decoration:none; color:inherit" href="#16">16</a>
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">2022-03-15 14:27:34.877232: I tensorflow/core/platform/cpu_feature_guard.cc:142<span class="o">]</span> This TensorFlow binary is optimized with oneAPI Deep Neural Network Library <span class="o">(</span>oneDNN<span class="o">)</span> to use the following CPU instructions in performance-critical operations:  SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
To <span class="nb">enable</span> them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2022-03-15 14:27:34.887611: I tensorflow/core/common_runtime/process_util.cc:146<span class="o">]</span> Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads <span class="k">for</span> best performance.
2022-03-15 14:27:38.063857: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:185<span class="o">]</span> None of the MLIR Optimization Passes are enabled <span class="o">(</span>registered 2<span class="o">)</span>
Epoch 1/5
1875/1875 <span class="o">[==============================]</span> - 36s 19ms/step - loss: 0.2993 - accuracy: 0.9140
Epoch 2/5
1875/1875 <span class="o">[==============================]</span> - 18s 10ms/step - loss: 0.1436 - accuracy: 0.9575
Epoch 3/5
1875/1875 <span class="o">[==============================]</span> - 17s 9ms/step - loss: 0.1080 - accuracy: 0.9675
Epoch 4/5
1875/1875 <span class="o">[==============================]</span> - 19s 10ms/step - loss: 0.0866 - accuracy: 0.9739
Epoch 5/5
1875/1875 <span class="o">[==============================]</span> - 52s 28ms/step - loss: 0.0750 - accuracy: 0.9762
313/313 - 4s - loss: 0.0782 - accuracy: 0.9779
<span class="o">[</span>0.078231580555439, 0.9779000282287598<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ë”-ì•Œì•„ë³´ê¸°">ë” ì•Œì•„ë³´ê¸°<a hidden class="anchor" aria-hidden="true" href="#ë”-ì•Œì•„ë³´ê¸°">#</a></h2>
<p><a href="https://ubccr.freshdesk.com/support/solutions/articles/5000688140-submitting-a-slurm-job-script">Submitting a slurm job script</a></p>
<p><a href="https://doc.zih.tu-dresden.de/jobs_and_resources/slurm_examples/">SLRUM Job Examples</a></p>
<p><a href="https://researchcomputing.princeton.edu/support/knowledge-base/tensorflow">TensorFlow on the HPC Clusters</a></p>


  </div>

  <footer class="post-footer">
<nav class="paginav">
  <a class="next" href="https://hpc.stat.yonsei.ac.kr/docs/how-to-use-cpu-node_r/">
    <span class="title">Next Page Â»</span>
    <br>
    <span>3. CPU node ì‚¬ìš©ë²•(R)</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <p align="center">
        <a href="http://bk21-bigdata.yonsei.ac.kr/bbs/page.php?hid=equipment">
        <img width='70%' src='https://hpc.stat.yonsei.ac.kr/images/logo.svg' alt='Yonsei BK logo'>
        </a>
        <br>
    </p>
    <span>&copy; 2022 <a href="https://hpc.stat.yonsei.ac.kr">Chili Pepper</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
